# The container definition we want to use for developing our app

box: oraclelinux:7.4

build:
  steps:

   - script:
     name: Downloading & Installing "wget" package
     code: |
      sudo yum install wget -y

   - script:
      name: Create "/u01/installs" directory to store all third party dependencies
      code: |
       mkdir -p /u01/installs

   - script:
      name: Download & Copy JAVA dependency to a "/u01/installs" directory
      code: |
       cd /u01/installs
       echo ""; echo "Current working directory is :" `pwd`
       echo ""
       wget --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie" \
           $(curl -s http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html | \
               awk "/downloads\['/ && ! /demos/ && /\['files'\]/ && /linux-x64/ && /\.tar\.gz/" | \
               grep -o 'http.*\.tar\.gz' | tail -n 1 \
           )
       wget --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie" \
           $(curl -s http://www.oracle.com/technetwork/java/javase/downloads/jre8-downloads-2133155.html | \
               awk "/downloads\['/ && ! /demos/ && /\['files'\]/ && /linux-x64/ && /\.tar\.gz/" | \
               grep -o 'http.*\.tar\.gz' | tail -n 1 \
           )

       chmod 777 `ls | tail -n 2`
       echo ""; ls -ltr *

   - script:
      name: Extract the jdk*.tar.gz and jre*.tar.gz files to /u01/installs directory
      code: |
       cd /u01/installs
       tar zxf `ls jdk*.tar.gz`
       tar zxf `ls jre*.tar.gz`
       mv `ls -d jdk*` jdk
       mv `ls -d jre*` jre
       echo ""; ls -ltr jdk
       export
#
#   - script:
#      name: install dependencies
#      code: |
#       set GOROOT=/usr/local/go
#       set GOPATH=$HOME/go
#       set GOBIN=$GOPATH/bin
#       set PATH=$GOPATH:$GOBIN:$PATH
#
#       cd $WERCKER_SOURCE_DIR
#       make vendor
#
#   - script:
#      name: build and stage the project
#      code: |
#       make docker-stage
#       ls -ltr
#       cp -r docker-stage/. $WERCKER_OUTPUT_DIR/
#       cp -r wercker/. $WERCKER_OUTPUT_DIR/
#
#
#push-release:
#  box: oraclelinux:7.3
#  steps:
#   - script:
#      name: copy distribution
#      code: |
#       mkdir -p /u01/oracle
#       cp -r $WERCKER_SOURCE_DIR/. /u01/oracle/
#
#   - internal/docker-push:
#      name: Push the third party dependency containing image to repository
#      username: $DOCKER_USERNAME
#      password: $DOCKER_PASSWORD
#      repository: docker.io/vpriyankaprabhu/thirdpartydependencystdimage
#      tag: $WERCKER_GIT_COMMIT
#      working-dir: /u01/installs/
#      registry: https://docker.io